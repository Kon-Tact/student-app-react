{"ast":null,"code":"import{Button,Paper,Table,TableBody,TableCell,TableContainer,TableHead,TableRow}from'@mui/material';import React,{useEffect,useState}from'react';import Student from'../models/Student';import ApiAccess from'../services/api-access';import Loader from'../component/loader';import{useHistory}from'react-router-dom';import routes from'../helpers/routes';import EditIcon from'@mui/icons-material/Edit';import DeleteIcon from'@mui/icons-material/Delete';import cookieServiceInstance from'../services/cookies';import SlideDialog from'../component/MaterialModal';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const StudentsList=()=>{const[studentList,setList]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(false);const[isEditDialogOpen,setEditDialog]=useState(false);const[isDeleteDialogOpen,setDeleteDialog]=useState(false);const[actionStudent,setActionStudent]=useState(new Student());useEffect(()=>{const fetchData=async()=>{try{const students=await ApiAccess.getStudents();console.table(students);setList(students);}catch(error){console.error(error);setError(true);}finally{setLoading(false);}};fetchData();},[]);const history=useHistory();const goToPage=path=>{history.push(path);};const goToEdition=()=>{cookieServiceInstance.setCookie('edition',JSON.stringify(actionStudent),1);goToPage(routes.editstudent);};const deleteStudent=async()=>{setLoading(true);try{await ApiAccess.deleteStudent(actionStudent).then(()=>{setList(prevList=>prevList.filter(s=>s.id!==actionStudent.id));setDeleteDialog(false);});}catch{console.error(\"Error fetching the delete endpoint\");}finally{setLoading(false);}};const openEditDialog=student=>{setActionStudent(student);setEditDialog(true);};const closeEditDialog=()=>{setEditDialog(false);};const openDeleteDialog=student=>{setActionStudent(student);setDeleteDialog(true);};const closeDeleteDialog=()=>{setDeleteDialog(false);};return/*#__PURE__*/_jsxs(\"div\",{children:[loading?/*#__PURE__*/_jsx(\"div\",{className:\"center\",children:/*#__PURE__*/_jsx(Loader,{})}):error?/*#__PURE__*/_jsx(\"h4\",{className:\"center\",children:\"L'api ne semble pas joignable\"}):studentList.length>0?/*#__PURE__*/_jsx(TableContainer,{component:Paper,children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Name\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Phone Number\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Email\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Address\"}),/*#__PURE__*/_jsx(TableCell,{})]})}),/*#__PURE__*/_jsx(TableBody,{children:studentList.map(student=>/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:student.name}),/*#__PURE__*/_jsx(TableCell,{children:student.phoneNumber}),/*#__PURE__*/_jsx(TableCell,{children:student.email}),/*#__PURE__*/_jsx(TableCell,{children:student.address}),/*#__PURE__*/_jsxs(TableCell,{style:{width:'12%'},children:[/*#__PURE__*/_jsx(Button,{onClick:()=>openEditDialog(student),children:/*#__PURE__*/_jsx(EditIcon,{})}),/*#__PURE__*/_jsx(Button,{onClick:()=>openDeleteDialog(student),children:/*#__PURE__*/_jsx(DeleteIcon,{})})]})]},student.id))})]})}):/*#__PURE__*/_jsx(\"h4\",{className:\"center\",children:\"La liste d'\\xE9tudiants est vide\"}),/*#__PURE__*/_jsx(SlideDialog,{isOpen:isEditDialogOpen,onClose:closeEditDialog,onConfirm:goToEdition,title:'Edition',children:loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Vous allez vers l'\\xE9dition\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Souhaitez vous continuer ?\"})]})}),/*#__PURE__*/_jsx(SlideDialog,{isOpen:isDeleteDialogOpen,onClose:closeDeleteDialog,onConfirm:deleteStudent,title:'Suppression',children:loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Vous allez supprimer cet \\xE9tudiant\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\xCAtes vous s\\xFBr de continuer ?\"})]})})]});};export default StudentsList;","map":{"version":3,"names":["Button","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","React","useEffect","useState","Student","ApiAccess","Loader","useHistory","routes","EditIcon","DeleteIcon","cookieServiceInstance","SlideDialog","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","StudentsList","studentList","setList","loading","setLoading","error","setError","isEditDialogOpen","setEditDialog","isDeleteDialogOpen","setDeleteDialog","actionStudent","setActionStudent","fetchData","students","getStudents","console","table","history","goToPage","path","push","goToEdition","setCookie","JSON","stringify","editstudent","deleteStudent","then","prevList","filter","s","id","openEditDialog","student","closeEditDialog","openDeleteDialog","closeDeleteDialog","children","className","length","component","map","name","phoneNumber","email","address","style","width","onClick","isOpen","onClose","onConfirm","title"],"sources":["C:/Users/GODINGEN MARIE/Documents/student-app-react/src/pages/students-list-page.tsx"],"sourcesContent":["import { Button, Paper, Table, TableBody, TableCell, TableContainer, TableHead, TableRow } from '@mui/material';\r\nimport React, { FunctionComponent, useEffect, useState } from 'react';\r\nimport Student from '../models/Student';\r\nimport ApiAccess from '../services/api-access';\r\nimport Loader from '../component/loader';\r\nimport { useHistory } from 'react-router-dom';\r\nimport routes from '../helpers/routes';\r\nimport EditIcon from '@mui/icons-material/Edit';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport cookieServiceInstance from '../services/cookies';\r\nimport SlideDialog from '../component/MaterialModal';\r\n\r\nconst StudentsList: FunctionComponent = () => {\r\n\r\n    const [studentList, setList] = useState<Student[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(false);\r\n    const [isEditDialogOpen, setEditDialog] = useState(false);\r\n    const [isDeleteDialogOpen, setDeleteDialog] = useState(false);\r\n    const [actionStudent, setActionStudent] = useState(new Student());\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                const students = await ApiAccess.getStudents();\r\n                console.table(students);\r\n                setList(students)\r\n            } catch (error) {\r\n                console.error(error);\r\n                setError(true);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        }\r\n        fetchData();\r\n    }, []);\r\n\r\n    const history = useHistory();\r\n\r\n    const goToPage = (path: any) => {\r\n        history.push(path);\r\n    };\r\n\r\n    const goToEdition = () => {\r\n        cookieServiceInstance.setCookie('edition', JSON.stringify(actionStudent), 1);\r\n        goToPage(routes.editstudent);\r\n    }\r\n\r\n    const deleteStudent = async () => {\r\n        setLoading(true);\r\n        try {\r\n            await ApiAccess.deleteStudent(actionStudent)\r\n                .then(() => {\r\n                    setList(prevList => prevList.filter(s => s.id !== actionStudent.id))\r\n                    setDeleteDialog(false);\r\n                })\r\n        } catch {\r\n            console.error(\"Error fetching the delete endpoint\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    const openEditDialog = (student: Student) => {\r\n        setActionStudent(student);\r\n        setEditDialog(true);\r\n    }\r\n\r\n    const closeEditDialog = () => {\r\n        setEditDialog(false);\r\n    }\r\n\r\n    const openDeleteDialog = (student: Student) => {\r\n        setActionStudent(student);\r\n        setDeleteDialog(true);\r\n    }\r\n\r\n    const closeDeleteDialog = () => {\r\n        setDeleteDialog(false);\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            {loading ? (\r\n                <div className=\"center\"><Loader /></div>\r\n            ) : error ? (\r\n                <h4 className=\"center\">L'api ne semble pas joignable</h4>\r\n            ) : studentList.length > 0 ? (\r\n                <TableContainer component={Paper}>\r\n                    <Table>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Name</TableCell>\r\n                                <TableCell>Phone Number</TableCell>\r\n                                <TableCell>Email</TableCell>\r\n                                <TableCell>Address</TableCell>\r\n                                <TableCell></TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableBody>\r\n                            {studentList.map(student => (\r\n                                <TableRow key={student.id}>\r\n                                    <TableCell>{student.name}</TableCell>\r\n                                    <TableCell>{student.phoneNumber}</TableCell>\r\n                                    <TableCell>{student.email}</TableCell>\r\n                                    <TableCell>{student.address}</TableCell>\r\n                                    <TableCell style={{ width: '12%' }}>\r\n                                        <Button onClick={() => openEditDialog(student)}>\r\n                                            <EditIcon />\r\n                                        </Button>\r\n                                        <Button onClick={() => openDeleteDialog(student)}>\r\n                                            <DeleteIcon />\r\n                                        </Button>\r\n                                    </TableCell>\r\n                                </TableRow>\r\n                            ))}\r\n                        </TableBody>\r\n                    </Table>\r\n                </TableContainer>\r\n            ) : (\r\n                <h4 className=\"center\">La liste d'étudiants est vide</h4>\r\n            )}\r\n\r\n            <SlideDialog isOpen={isEditDialogOpen} onClose={closeEditDialog} onConfirm={goToEdition} title={'Edition'}>\r\n                {loading ? (\r\n                    <Loader />\r\n                ) : (\r\n                    <>\r\n                        <p>Vous allez vers l'édition</p>\r\n                        <p>Souhaitez vous continuer ?</p>\r\n                    </>\r\n                )}\r\n            </SlideDialog>\r\n            <SlideDialog isOpen={isDeleteDialogOpen} onClose={closeDeleteDialog} onConfirm={deleteStudent} title={'Suppression'}>\r\n                {loading ? (\r\n                    <Loader />\r\n                ) : (\r\n                    <>\r\n                        <p>Vous allez supprimer cet étudiant</p>\r\n                        <p>Êtes vous sûr de continuer ?</p>\r\n                    </>\r\n                )}\r\n            </SlideDialog>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default StudentsList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}