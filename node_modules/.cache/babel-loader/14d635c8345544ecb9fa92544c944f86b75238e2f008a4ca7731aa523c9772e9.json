{"ast":null,"code":"import React,{useState}from'react';import{TextField,Button,Grid,Paper,Typography,IconButton,Snackbar}from'@mui/material';import ApiAccess from'../services/api-access';import Credentials from'../models/Credentials';import{useHistory}from'react-router-dom';import CloseIcon from'@mui/icons-material/Close';import routes from'../helpers/routes';import Loader from'../component/loader';import ConnectManager from'../services/connexion';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ConnectionPage=()=>{const history=useHistory();const[loading,setLoading]=useState(false);const[isBadCredentialSnackOpen,setSnack]=useState(false);const[connectionForm,setConnectionForm]=useState({username:'',password:''});const handleChange=e=>{const{name,value}=e.target;setConnectionForm({...connectionForm,[name]:value});};const handleSubmit=async e=>{e.preventDefault();setLoading(true);try{const accountResponse=await ApiAccess.login(new Credentials(connectionForm.username,connectionForm.password));console.log(accountResponse.token);if(accountResponse.token){try{ConnectManager.connection(accountResponse);}catch(error){console.error(error);}}else{setSnack(true);console.log(\"Bad credentials\");setConnectionForm({username:connectionForm.username,password:''});}}catch(error){console.error('Error fetching API :',error);}finally{setLoading(false);history.push(routes.home);window.location.reload();}};const closeSnack=()=>{setSnack(false);};const action=/*#__PURE__*/_jsx(IconButton,{size:\"small\",\"aria-label\":\"close\",color:\"inherit\",onClick:closeSnack,children:/*#__PURE__*/_jsx(CloseIcon,{fontSize:\"small\"})});return/*#__PURE__*/_jsx(Grid,{container:true,justifyContent:\"center\",alignItems:\"top\",marginTop:3,style:{minHeight:'100vh'},children:/*#__PURE__*/_jsxs(Grid,{item:true,xs:10,sm:6,md:6,children:[/*#__PURE__*/_jsx(Snackbar,{anchorOrigin:{vertical:'bottom',horizontal:'center'},open:isBadCredentialSnackOpen,autoHideDuration:3000,onClose:closeSnack,message:\"L'identifiant ou le mot de passe n'ont pas \\xE9t\\xE9 reconnus\",action:action}),/*#__PURE__*/_jsxs(Paper,{elevation:4,style:{padding:'20px'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",component:\"h2\",gutterBottom:true,children:\"Connexion\"}),loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(TextField,{label:\"Username\",name:\"username\",value:connectionForm.username,onChange:handleChange,fullWidth:true,margin:\"normal\",variant:\"standard\",required:true}),/*#__PURE__*/_jsx(TextField,{label:\"Password\",name:\"password\",type:\"password\",value:connectionForm.password,onChange:handleChange,fullWidth:true,margin:\"normal\",variant:\"standard\",required:true}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",fullWidth:true,children:\"Se connecter\"})]})]})]})});};export default ConnectionPage;","map":{"version":3,"names":["React","useState","TextField","Button","Grid","Paper","Typography","IconButton","Snackbar","ApiAccess","Credentials","useHistory","CloseIcon","routes","Loader","ConnectManager","jsx","_jsx","jsxs","_jsxs","ConnectionPage","history","loading","setLoading","isBadCredentialSnackOpen","setSnack","connectionForm","setConnectionForm","username","password","handleChange","e","name","value","target","handleSubmit","preventDefault","accountResponse","login","console","log","token","connection","error","push","home","window","location","reload","closeSnack","action","size","color","onClick","children","fontSize","container","justifyContent","alignItems","marginTop","style","minHeight","item","xs","sm","md","anchorOrigin","vertical","horizontal","open","autoHideDuration","onClose","message","elevation","padding","variant","component","gutterBottom","onSubmit","label","onChange","fullWidth","margin","required","type"],"sources":["C:/Users/GODINGEN MARIE/Documents/student-app-react/src/pages/connection-page.tsx"],"sourcesContent":["import React, { ChangeEvent, FunctionComponent, useState } from 'react';\r\nimport { TextField, Button, Grid, Paper, Typography, IconButton, Snackbar } from '@mui/material';\r\nimport ApiAccess from '../services/api-access';\r\nimport Credentials from '../models/Credentials';\r\nimport { useHistory } from 'react-router-dom';\r\nimport CloseIcon from '@mui/icons-material/Close';\r\nimport routes from '../helpers/routes';\r\nimport Loader from '../component/loader';\r\nimport ConnectManager from '../services/connexion';\r\n\r\nconst ConnectionPage: FunctionComponent = () => {\r\n  const history = useHistory();\r\n  const [loading, setLoading] = useState(false);\r\n  const [isBadCredentialSnackOpen, setSnack] = useState(false);\r\n  const [connectionForm, setConnectionForm] = useState({\r\n    username: '',\r\n    password: '',\r\n  });\r\n\r\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n    const { name, value } = e.target;\r\n    setConnectionForm({\r\n      ...connectionForm,\r\n      [name]: value,\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    try {\r\n      const accountResponse = await ApiAccess.login(new Credentials(connectionForm.username, connectionForm.password));\r\n      console.log(accountResponse.token);\r\n      if (accountResponse.token) {\r\n        try {\r\n          ConnectManager.connection(accountResponse);\r\n        } catch (error) {\r\n          console.error(error);\r\n        }\r\n      } else {\r\n        setSnack(true);\r\n        console.log(\"Bad credentials\");\r\n        setConnectionForm({username: connectionForm.username, password: '' });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching API :', error);\r\n    } finally {\r\n      setLoading(false);\r\n      history.push(routes.home);\r\n      window.location.reload();\r\n    }\r\n  };\r\n\r\n  const closeSnack = () => {\r\n    setSnack(false);\r\n  }\r\n\r\n  const action = (\r\n    <IconButton\r\n      size=\"small\"\r\n      aria-label=\"close\"\r\n      color=\"inherit\"\r\n      onClick={closeSnack}\r\n    >\r\n      <CloseIcon fontSize=\"small\" />\r\n    </IconButton>\r\n  );\r\n\r\n  return (\r\n    <Grid container justifyContent=\"center\" alignItems=\"top\" marginTop={3} style={{ minHeight: '100vh' }}>\r\n      <Grid item xs={10} sm={6} md={6}>\r\n        <Snackbar\r\n          anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\r\n          open={isBadCredentialSnackOpen}\r\n          autoHideDuration={3000}\r\n          onClose={closeSnack}\r\n          message=\"L'identifiant ou le mot de passe n'ont pas été reconnus\"\r\n          action={action}\r\n        />\r\n        <Paper elevation={4} style={{ padding: '20px' }}>\r\n          <Typography variant=\"h5\" component=\"h2\" gutterBottom>\r\n            Connexion\r\n          </Typography>\r\n          {loading ? (\r\n            <Loader />\r\n          ) : (\r\n            <form onSubmit={handleSubmit}>\r\n              <TextField\r\n                label=\"Username\"\r\n                name=\"username\"\r\n                value={connectionForm.username}\r\n                onChange={handleChange}\r\n                fullWidth\r\n                margin=\"normal\"\r\n                variant=\"standard\"\r\n                required\r\n              />\r\n              <TextField\r\n                label=\"Password\"\r\n                name=\"password\"\r\n                type=\"password\"\r\n                value={connectionForm.password}\r\n                onChange={handleChange}\r\n                fullWidth\r\n                margin=\"normal\"\r\n                variant=\"standard\"\r\n                required\r\n              />\r\n              <Button type=\"submit\" variant=\"contained\" color=\"primary\" fullWidth>\r\n                Se connecter\r\n              </Button>\r\n            </form>\r\n          )}\r\n        </Paper>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n};\r\n\r\nexport default ConnectionPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}