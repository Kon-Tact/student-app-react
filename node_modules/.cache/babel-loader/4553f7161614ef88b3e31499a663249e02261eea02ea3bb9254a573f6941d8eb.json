{"ast":null,"code":"import React,{useEffect,useState}from'react';import ApiAccess from'../services/api-access';import Account from'../models/Account';import Grid from'@mui/material/Grid/Grid';import Typography from'@mui/material/Typography/Typography';import Paper from'@mui/material/Paper/Paper';import TextField from'@mui/material/TextField/TextField';import Button from'@mui/material/Button/Button';import cookieServiceInstance from'../services/cookies';import{Checkbox,IconButton,Snackbar}from'@mui/material';import CloseIcon from'@mui/icons-material/Close';import Loader from'../component/loader';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AccountEdition=()=>{let SnackStatus=/*#__PURE__*/function(SnackStatus){SnackStatus[\"SUCCESS\"]=\"SUCCESS\";SnackStatus[\"ERROR\"]=\"ERROR\";return SnackStatus;}({});;const[loading,setLoading]=useState(false);const[snackStatus,setSnackStatus]=useState(null);const[accountEditionForm,setAccountEditionForm]=useState({username:'',email:'',isAdmin:false});const[editionAccount,setEditionAccount]=useState(new Account());const handleChange=e=>{const{name,value}=e.target;setAccountEditionForm({...accountEditionForm,[name]:value});};const checkboxManagement=()=>{accountEditionForm.isAdmin?setAccountEditionForm({...accountEditionForm,isAdmin:false}):setAccountEditionForm({...accountEditionForm,isAdmin:true});};const handleSubmit=async e=>{e.preventDefault();const account=new Account(accountEditionForm.username,'',accountEditionForm.email);account.role=accountEditionForm.isAdmin?'ADMIN':'USER';account.id=editionAccount.id;console.table(account);try{setLoading(true);await ApiAccess.editAccount(account);}catch(error){setSnackStatus(SnackStatus.ERROR);}finally{setLoading(false);setSnackStatus(SnackStatus.SUCCESS);}};const getMessage=status=>{switch(status){case SnackStatus.SUCCESS:return\"Le compte a bien été mis à jour\";case SnackStatus.ERROR:return\"Une erreur est survenu\";}};useEffect(()=>{const storedAccount=cookieServiceInstance.getCookie('edition');if(storedAccount){setEditionAccount(JSON.parse(storedAccount));console.table(storedAccount);}},[]);useEffect(()=>{const fillForm=()=>{setAccountEditionForm({username:editionAccount.username,email:editionAccount.email,isAdmin:editionAccount.role.includes('ADMIN')});};fillForm();},[editionAccount]);const closeSnack=()=>{setSnackStatus(null);};const action=/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",\"aria-label\":\"close\",color:\"inherit\",onClick:closeSnack,children:/*#__PURE__*/_jsx(CloseIcon,{fontSize:\"small\"})})});return/*#__PURE__*/_jsx(Grid,{container:true,justifyContent:\"center\",alignItems:\"top\",marginTop:3,style:{minHeight:'100vh'},children:/*#__PURE__*/_jsx(Grid,{item:true,xs:10,sm:6,md:4,children:/*#__PURE__*/_jsxs(Paper,{elevation:3,style:{padding:'20px'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",component:\"h2\",gutterBottom:true,children:\"Edition de compte\"}),loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(TextField,{label:\"Username\",name:\"username\",value:accountEditionForm.username,onChange:handleChange,fullWidth:true,margin:\"normal\",variant:\"standard\"}),/*#__PURE__*/_jsx(TextField,{label:\"Email\",name:\"email\",type:\"text\",value:accountEditionForm.email,onChange:handleChange,fullWidth:true,margin:\"normal\",variant:\"standard\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Admin\"}),/*#__PURE__*/_jsx(Checkbox,{name:\"isAdmin\",checked:accountEditionForm.isAdmin,onClick:checkboxManagement}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",fullWidth:true,children:\"Editer\"})]}),/*#__PURE__*/_jsx(Snackbar,{anchorOrigin:{vertical:'bottom',horizontal:'center'},open:snackStatus!==null,autoHideDuration:3000,onClose:closeSnack,message:snackStatus?getMessage(snackStatus):'',action:action})]})})});};export default AccountEdition;","map":{"version":3,"names":["React","useEffect","useState","ApiAccess","Account","Grid","Typography","Paper","TextField","Button","cookieServiceInstance","Checkbox","IconButton","Snackbar","CloseIcon","Loader","jsx","_jsx","jsxs","_jsxs","AccountEdition","SnackStatus","loading","setLoading","snackStatus","setSnackStatus","accountEditionForm","setAccountEditionForm","username","email","isAdmin","editionAccount","setEditionAccount","handleChange","e","name","value","target","checkboxManagement","handleSubmit","preventDefault","account","role","id","console","table","editAccount","error","ERROR","SUCCESS","getMessage","status","storedAccount","getCookie","JSON","parse","fillForm","includes","closeSnack","action","Fragment","children","size","color","onClick","fontSize","container","justifyContent","alignItems","marginTop","style","minHeight","item","xs","sm","md","elevation","padding","variant","component","gutterBottom","onSubmit","label","onChange","fullWidth","margin","type","checked","anchorOrigin","vertical","horizontal","open","autoHideDuration","onClose","message"],"sources":["C:/Users/GODINGEN MARIE/Documents/student-app-react/src/pages/account-edition-page.tsx"],"sourcesContent":["import React, { ChangeEvent, FunctionComponent, useEffect, useState } from 'react';\r\nimport ApiAccess from '../services/api-access';\r\nimport Account from '../models/Account';\r\nimport Grid from '@mui/material/Grid/Grid';\r\nimport Typography from '@mui/material/Typography/Typography';\r\nimport Paper from '@mui/material/Paper/Paper';\r\nimport TextField from '@mui/material/TextField/TextField';\r\nimport Button from '@mui/material/Button/Button';\r\nimport cookieServiceInstance from '../services/cookies';\r\nimport { Checkbox, IconButton, Snackbar } from '@mui/material';\r\nimport CloseIcon from '@mui/icons-material/Close';\r\nimport Loader from '../component/loader';\r\n\r\nconst AccountEdition: FunctionComponent = () => {\r\n\r\n    enum SnackStatus { SUCCESS = 'SUCCESS', ERROR = 'ERROR'};\r\n    const [loading, setLoading] = useState(false);\r\n    const [snackStatus, setSnackStatus] = useState<SnackStatus | null> (null);\r\n    const [accountEditionForm, setAccountEditionForm] = useState({\r\n        username: '',\r\n        email: '',\r\n        isAdmin: false\r\n    });\r\n\r\n    const [editionAccount, setEditionAccount] = useState(new Account());\r\n\r\n    const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n        const { name, value } = e.target;\r\n        setAccountEditionForm({\r\n            ...accountEditionForm,\r\n            [name]: value,\r\n        });\r\n    };\r\n\r\n    const checkboxManagement = () => {\r\n        accountEditionForm.isAdmin ? setAccountEditionForm({ ...accountEditionForm, isAdmin: false }) : setAccountEditionForm({ ...accountEditionForm, isAdmin: true });\r\n    }\r\n\r\n    const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n        const account: Account = new Account(accountEditionForm.username, '', accountEditionForm.email);\r\n        account.role = accountEditionForm.isAdmin ? 'ADMIN' : 'USER';\r\n        account.id = editionAccount.id;\r\n        console.table(account);\r\n        try {\r\n            setLoading(true);\r\n            await ApiAccess.editAccount(account);\r\n        } catch (error) {\r\n            setSnackStatus(SnackStatus.ERROR);\r\n        } finally {\r\n            setLoading(false);\r\n            setSnackStatus(SnackStatus.SUCCESS);\r\n        }\r\n    };\r\n\r\n    const getMessage = (status: SnackStatus): string => {\r\n        switch (status) {\r\n            case SnackStatus.SUCCESS : return \"Le compte a bien été mis à jour\";\r\n            case SnackStatus.ERROR : return \"Une erreur est survenu\";\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        const storedAccount = cookieServiceInstance.getCookie('edition');\r\n        if (storedAccount) {\r\n            setEditionAccount(JSON.parse(storedAccount));\r\n            console.table(storedAccount);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const fillForm = () => {\r\n            setAccountEditionForm({\r\n                username: editionAccount.username,\r\n                email: editionAccount.email,\r\n                isAdmin: editionAccount.role.includes('ADMIN')\r\n            });\r\n        };\r\n\r\n        fillForm();\r\n    }, [editionAccount]);\r\n\r\n    const closeSnack = () => {\r\n        setSnackStatus(null);\r\n    }\r\n\r\n    const action = (\r\n        <React.Fragment>\r\n            <IconButton\r\n                size=\"small\"\r\n                aria-label=\"close\"\r\n                color=\"inherit\"\r\n                onClick={closeSnack}\r\n            >\r\n                <CloseIcon fontSize=\"small\" />\r\n            </IconButton>\r\n        </React.Fragment>\r\n    );\r\n\r\n    return (\r\n        <Grid container justifyContent=\"center\" alignItems=\"top\" marginTop={3} style={{ minHeight: '100vh' }}>\r\n            <Grid item xs={10} sm={6} md={4}>\r\n                <Paper elevation={3} style={{ padding: '20px' }}>\r\n                    <Typography variant=\"h5\" component=\"h2\" gutterBottom>\r\n                        Edition de compte\r\n                    </Typography>\r\n                    {loading ? (\r\n                        <Loader />\r\n                    ) : (\r\n                        <form onSubmit={handleSubmit}>\r\n                            <TextField\r\n                                label=\"Username\"\r\n                                name=\"username\"\r\n                                value={accountEditionForm.username}\r\n                                onChange={handleChange}\r\n                                fullWidth\r\n                                margin=\"normal\"\r\n                                variant=\"standard\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Email\"\r\n                                name=\"email\"\r\n                                type=\"text\"\r\n                                value={accountEditionForm.email}\r\n                                onChange={handleChange}\r\n                                fullWidth\r\n                                margin=\"normal\"\r\n                                variant=\"standard\"\r\n                            />\r\n                            <label>Admin</label>\r\n                            <Checkbox\r\n                                name='isAdmin'\r\n                                checked={accountEditionForm.isAdmin}\r\n                                onClick={checkboxManagement}\r\n                            />\r\n                            <Button type=\"submit\" variant=\"contained\" color=\"primary\" fullWidth>\r\n                                Editer\r\n                            </Button>\r\n                        </form>\r\n                    )}\r\n                    <Snackbar\r\n                        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\r\n                        open={snackStatus !== null}\r\n                        autoHideDuration={3000}\r\n                        onClose={closeSnack}\r\n                        message={snackStatus ? getMessage(snackStatus) : ''}\r\n                        action={action}\r\n                    />\r\n                </Paper>\r\n            </Grid>\r\n        </Grid>\r\n    );\r\n}\r\n\r\nexport default AccountEdition;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}