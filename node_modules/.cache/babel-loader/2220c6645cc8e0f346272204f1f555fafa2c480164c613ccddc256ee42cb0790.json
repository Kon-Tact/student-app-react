{"ast":null,"code":"import React,{useEffect,useState}from'react';import ApiAccess from'../services/api-access';import Account from'../models/Account';import Grid from'@mui/material/Grid/Grid';import Typography from'@mui/material/Typography/Typography';import Paper from'@mui/material/Paper/Paper';import TextField from'@mui/material/TextField/TextField';import Button from'@mui/material/Button/Button';import cookieServiceInstance from'../services/cookies';import{Checkbox,IconButton,Snackbar}from'@mui/material';import CloseIcon from'@mui/icons-material/Close';import Loader from'../component/loader';import{useHistory}from'react-router-dom';import routes from'../helpers/routes';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AccountEdition=()=>{let SnackStatus=/*#__PURE__*/function(SnackStatus){SnackStatus[\"SUCCESS\"]=\"SUCCESS\";SnackStatus[\"ERROR\"]=\"ERROR\";return SnackStatus;}({});;const history=useHistory();const[loading,setLoading]=useState(false);const[snackStatus,setSnackStatus]=useState(null);const[accountEditionForm,setAccountEditionForm]=useState({username:'',email:'',isAdmin:false});const[editionAccount,setEditionAccount]=useState(new Account());const handleChange=e=>{const{name,value}=e.target;setAccountEditionForm({...accountEditionForm,[name]:value});};const checkboxManagement=()=>{accountEditionForm.isAdmin?setAccountEditionForm({...accountEditionForm,isAdmin:false}):setAccountEditionForm({...accountEditionForm,isAdmin:true});};const handleSubmit=async e=>{e.preventDefault();const account=new Account(accountEditionForm.username,'',accountEditionForm.email);account.role=accountEditionForm.isAdmin?'ADMIN':'USER';account.id=editionAccount.id;console.table(account);try{setLoading(true);await ApiAccess.editAccount(account);}catch(error){setSnackStatus(SnackStatus.ERROR);}finally{setLoading(false);setSnackStatus(SnackStatus.SUCCESS);history.push(routes.accounts);}};const getMessage=status=>{switch(status){case SnackStatus.SUCCESS:return\"Le compte a bien été mis à jour\";case SnackStatus.ERROR:return\"Une erreur est survenu\";}};useEffect(()=>{const storedAccount=cookieServiceInstance.getCookie('edition');if(storedAccount){setEditionAccount(JSON.parse(storedAccount));console.table(storedAccount);}},[]);useEffect(()=>{const fillForm=()=>{setAccountEditionForm({username:editionAccount.username,email:editionAccount.email,isAdmin:editionAccount.role.includes('ADMIN')});};fillForm();},[editionAccount]);const closeSnack=()=>{setSnackStatus(null);};const action=/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",\"aria-label\":\"close\",color:\"inherit\",onClick:closeSnack,children:/*#__PURE__*/_jsx(CloseIcon,{fontSize:\"small\"})})});return/*#__PURE__*/_jsx(Grid,{container:true,justifyContent:\"center\",alignItems:\"top\",marginTop:3,style:{minHeight:'100vh'},children:/*#__PURE__*/_jsx(Grid,{item:true,xs:10,sm:6,md:4,children:/*#__PURE__*/_jsxs(Paper,{elevation:3,style:{padding:'20px'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",component:\"h2\",gutterBottom:true,children:\"Edition de compte\"}),loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(TextField,{label:\"Username\",name:\"username\",value:accountEditionForm.username,onChange:handleChange,fullWidth:true,margin:\"normal\",variant:\"standard\"}),/*#__PURE__*/_jsx(TextField,{label:\"Email\",name:\"email\",type:\"text\",value:accountEditionForm.email,onChange:handleChange,fullWidth:true,margin:\"normal\",variant:\"standard\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Admin\"}),/*#__PURE__*/_jsx(Checkbox,{name:\"isAdmin\",checked:accountEditionForm.isAdmin,onClick:checkboxManagement}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",fullWidth:true,children:\"Editer\"})]}),/*#__PURE__*/_jsx(Snackbar,{anchorOrigin:{vertical:'bottom',horizontal:'center'},open:snackStatus!==null,autoHideDuration:3000,onClose:closeSnack,message:snackStatus?getMessage(snackStatus):'',action:action})]})})});};export default AccountEdition;","map":{"version":3,"names":["React","useEffect","useState","ApiAccess","Account","Grid","Typography","Paper","TextField","Button","cookieServiceInstance","Checkbox","IconButton","Snackbar","CloseIcon","Loader","useHistory","routes","jsx","_jsx","jsxs","_jsxs","AccountEdition","SnackStatus","history","loading","setLoading","snackStatus","setSnackStatus","accountEditionForm","setAccountEditionForm","username","email","isAdmin","editionAccount","setEditionAccount","handleChange","e","name","value","target","checkboxManagement","handleSubmit","preventDefault","account","role","id","console","table","editAccount","error","ERROR","SUCCESS","push","accounts","getMessage","status","storedAccount","getCookie","JSON","parse","fillForm","includes","closeSnack","action","Fragment","children","size","color","onClick","fontSize","container","justifyContent","alignItems","marginTop","style","minHeight","item","xs","sm","md","elevation","padding","variant","component","gutterBottom","onSubmit","label","onChange","fullWidth","margin","type","checked","anchorOrigin","vertical","horizontal","open","autoHideDuration","onClose","message"],"sources":["C:/Users/GODINGEN MARIE/Documents/student-app-react/src/pages/account-edition-page.tsx"],"sourcesContent":["import React, { ChangeEvent, FunctionComponent, useEffect, useState } from 'react';\r\nimport ApiAccess from '../services/api-access';\r\nimport Account from '../models/Account';\r\nimport Grid from '@mui/material/Grid/Grid';\r\nimport Typography from '@mui/material/Typography/Typography';\r\nimport Paper from '@mui/material/Paper/Paper';\r\nimport TextField from '@mui/material/TextField/TextField';\r\nimport Button from '@mui/material/Button/Button';\r\nimport cookieServiceInstance from '../services/cookies';\r\nimport { Checkbox, IconButton, Snackbar } from '@mui/material';\r\nimport CloseIcon from '@mui/icons-material/Close';\r\nimport Loader from '../component/loader';\r\nimport { useHistory } from 'react-router-dom';\r\nimport routes from '../helpers/routes';\r\n\r\nconst AccountEdition: FunctionComponent = () => {\r\n\r\n    enum SnackStatus { SUCCESS = 'SUCCESS', ERROR = 'ERROR'};\r\n    const history = useHistory();\r\n    const [loading, setLoading] = useState(false);\r\n    const [snackStatus, setSnackStatus] = useState<SnackStatus | null> (null);\r\n    const [accountEditionForm, setAccountEditionForm] = useState({\r\n        username: '',\r\n        email: '',\r\n        isAdmin: false\r\n    });\r\n\r\n    const [editionAccount, setEditionAccount] = useState(new Account());\r\n\r\n    const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n        const { name, value } = e.target;\r\n        setAccountEditionForm({\r\n            ...accountEditionForm,\r\n            [name]: value,\r\n        });\r\n    };\r\n\r\n    const checkboxManagement = () => {\r\n        accountEditionForm.isAdmin ? setAccountEditionForm({ ...accountEditionForm, isAdmin: false }) : setAccountEditionForm({ ...accountEditionForm, isAdmin: true });\r\n    }\r\n\r\n    const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n        const account: Account = new Account(accountEditionForm.username, '', accountEditionForm.email);\r\n        account.role = accountEditionForm.isAdmin ? 'ADMIN' : 'USER';\r\n        account.id = editionAccount.id;\r\n        console.table(account);\r\n        try {\r\n            setLoading(true);\r\n            await ApiAccess.editAccount(account);\r\n        } catch (error) {\r\n            setSnackStatus(SnackStatus.ERROR);\r\n        } finally {\r\n            setLoading(false);\r\n            setSnackStatus(SnackStatus.SUCCESS);\r\n            history.push(routes.accounts);\r\n        }\r\n    };\r\n\r\n    const getMessage = (status: SnackStatus): string => {\r\n        switch (status) {\r\n            case SnackStatus.SUCCESS : return \"Le compte a bien été mis à jour\";\r\n            case SnackStatus.ERROR : return \"Une erreur est survenu\";\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        const storedAccount = cookieServiceInstance.getCookie('edition');\r\n        if (storedAccount) {\r\n            setEditionAccount(JSON.parse(storedAccount));\r\n            console.table(storedAccount);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const fillForm = () => {\r\n            setAccountEditionForm({\r\n                username: editionAccount.username,\r\n                email: editionAccount.email,\r\n                isAdmin: editionAccount.role.includes('ADMIN')\r\n            });\r\n        };\r\n\r\n        fillForm();\r\n    }, [editionAccount]);\r\n\r\n    const closeSnack = () => {\r\n        setSnackStatus(null);\r\n    }\r\n\r\n    const action = (\r\n        <React.Fragment>\r\n            <IconButton\r\n                size=\"small\"\r\n                aria-label=\"close\"\r\n                color=\"inherit\"\r\n                onClick={closeSnack}\r\n            >\r\n                <CloseIcon fontSize=\"small\" />\r\n            </IconButton>\r\n        </React.Fragment>\r\n    );\r\n\r\n    return (\r\n        <Grid container justifyContent=\"center\" alignItems=\"top\" marginTop={3} style={{ minHeight: '100vh' }}>\r\n            <Grid item xs={10} sm={6} md={4}>\r\n                <Paper elevation={3} style={{ padding: '20px' }}>\r\n                    <Typography variant=\"h5\" component=\"h2\" gutterBottom>\r\n                        Edition de compte\r\n                    </Typography>\r\n                    {loading ? (\r\n                        <Loader />\r\n                    ) : (\r\n                        <form onSubmit={handleSubmit}>\r\n                            <TextField\r\n                                label=\"Username\"\r\n                                name=\"username\"\r\n                                value={accountEditionForm.username}\r\n                                onChange={handleChange}\r\n                                fullWidth\r\n                                margin=\"normal\"\r\n                                variant=\"standard\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Email\"\r\n                                name=\"email\"\r\n                                type=\"text\"\r\n                                value={accountEditionForm.email}\r\n                                onChange={handleChange}\r\n                                fullWidth\r\n                                margin=\"normal\"\r\n                                variant=\"standard\"\r\n                            />\r\n                            <label>Admin</label>\r\n                            <Checkbox\r\n                                name='isAdmin'\r\n                                checked={accountEditionForm.isAdmin}\r\n                                onClick={checkboxManagement}\r\n                            />\r\n                            <Button type=\"submit\" variant=\"contained\" color=\"primary\" fullWidth>\r\n                                Editer\r\n                            </Button>\r\n                        </form>\r\n                    )}\r\n                    <Snackbar\r\n                        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\r\n                        open={snackStatus !== null}\r\n                        autoHideDuration={3000}\r\n                        onClose={closeSnack}\r\n                        message={snackStatus ? getMessage(snackStatus) : ''}\r\n                        action={action}\r\n                    />\r\n                </Paper>\r\n            </Grid>\r\n        </Grid>\r\n    );\r\n}\r\n\r\nexport default AccountEdition;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}